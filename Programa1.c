/***************************************************************************/
/***** Proyecto: Car Racing                                            *****/
/***************************************************************************/
/***** Microcontrolador: TM4C123GH6PM                                  *****/
/***** EvalBoard: Tiva C Series TM4C123G LaunchPad                     *****/
/***** Autores:                                                        *****/
/***** -Adrian Anhuaman                                                *****/
/***** -Yerodin Cuellar                                                *****/
/***** Fecha: 2022-1                                                   *****/
/***************************************************************************/
/***** Enunciado:                                                      *****/
/***** Hacer el proyecto mas fachero                                   *****/
/*****                                                                 *****/
/***** Parámetros UART:                                                *****/
/***** 19200 bps, 8 bits de datos, 1 bit de parada, paridad impar.     *****/
/***** habilitación de FIFO                                            *****/
/***************************************************************************/
#include <stdint.h>
#include <stdlib.h>
#include "tm4c123gh6pm.h"
#include "Nokia5110.h"
#include <math.h>
#include "Uart.h"
#include "DAC.h"
#include "Timer.h"

uint32_t timer=0;

void actualizarTimer(){
	if((NVIC_ST_CTRL_R & NVIC_ST_CTRL_COUNT)){
 //cada vez que pase 1ms, el contador de tiempo se incrementa
		timer++;
 }
}

void Camino(void){
	uint8_t i;
	for(i=0; i<=5; i++){
				Nokia5110_SetCursor(3,i);
				Nokia5110_OutString("|");
				Nokia5110_SetCursor(8,i);
        Nokia5110_OutString("|");
			}
}
const uint8_t selector_x[]={-10,4,29,53,4,29};
const uint8_t selector_y[]={-10,30,30,30,47,47};

const unsigned char Objeto[]={
0x42, 0x4D, 0xB6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x28,
0x00, 0x00, 0x00, 0x0E, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0x00,
0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80, 0x80, 0x00, 0x80, 0x00, 0x00, 0x00, 0x80,
0x00, 0x80, 0x00, 0x80, 0x80, 0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0xC0, 0xC0, 0xC0, 0x00,
0x00, 0x00, 0xFF, 0x00, 0x00, 0xFF, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF, 0x00, 0x00,
0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0xF0,
0x00, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0xF0, 0x00, 0x00, 0x00,
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x0F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF0, 0x00,
0x0F, 0xFF, 0x0F, 0xFF, 0xF0, 0xFF, 0xF0, 0x00, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF, 0xF0, 0xF0,
0x00, 0x0F, 0x00, 0xF0, 0x00, 0x0F, 0x00, 0xF0, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0xF0,
0x00, 0x00, 0xFF,};

const unsigned char Selector[]={
0x42, 0x4D, 0xC6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x28,
0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x01,0x00,0x04,0x00,0x00,0x00,
0x00,0x00,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x80,
0x00,0x00,0x00,0x80,0x80,0x00,0x80,0x00,0x00,0x00,0x80,0x00,0x80,0x00,0x80,0x80,
0x00,0x00,0x80,0x80,0x80,0x00,0xC0,0xC0,0xC0,0x00,0x00,0x00,0xFF,0x00,0x00,0xFF,
0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0xFF,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0xff};

const unsigned char Enemy10Point1[]={
0x42, 0x4D, 0xC6, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x28,
0x00,0x00,0x00,0x10,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x01,0x00,0x04,0x00,0x00,0x00,
0x00,0x00,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00,0x80,
0x00,0x00,0x00,0x80,0x80,0x00,0x80,0x00,0x00,0x00,0x80,0x00,0x80,0x00,0x80,0x80,
0x00,0x00,0x80,0x80,0x80,0x00,0xC0,0xC0,0xC0,0x00,0x00,0x00,0xFF,0x00,0x00,0xFF,
0x00,0x00,0x00,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,0xFF,0x00,0x00,0xFF,0xFF,0x00,0x00,0xFF,
0xFF,0x00,0x00,0xFF,0xFF,0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,
0xFF,0xFF,0xFF,0xFF,0x00,0x00,0xff};

int main(void)
{
  Nokia5110_Init();
  Nokia5110_Clear();
	/*ConfiguraTimer_1ms();*/
	ConfigUART0();
	uint8_t nivel;
	char lectura;
	lectura = 0x00;
	int x=35;
	uint32_t i;
	Nokia5110_ClearBuffer();
	Nokia5110_PrintBMP(x, 47, Enemy10Point1, 2);
	Nokia5110_DisplayBuffer();
	Nokia5110_PrintBMP(x, 47, Enemy10Point1, 2);
	Nokia5110_DisplayBuffer();
	Nokia5110_OutString("Car Racing");
	Nokia5110_SetCursor(0,1);
	Nokia5110_OutString("Presione");
	Nokia5110_SetCursor(0,2);
	Nokia5110_OutString("Un pulsador");
	Nokia5110_SetCursor(0,3);
	Nokia5110_OutString("Para jugar");
	while(1){
		for(i = 0; i<1000000; i++){
		}
	  Nokia5110_SetCursor(0,0);
    Nokia5110_ClearBuffer();
	  Nokia5110_DisplayBuffer();
	  Nokia5110_OutString("Car Racing");
	  Nokia5110_SetCursor(0,1);
	  Nokia5110_OutString("Presione");
	  Nokia5110_SetCursor(0,2);
	  Nokia5110_OutString("Un pulsador");
	  Nokia5110_SetCursor(0,3);
	  Nokia5110_OutString("Para jugar");
		for(i = 0; i<1000000; i++){
		}
		Nokia5110_PrintBMP(x, 47, Enemy10Point1, 2);
		Nokia5110_DisplayBuffer();
		Nokia5110_OutString("Car Racing");
	  Nokia5110_SetCursor(0,1);
	  Nokia5110_OutString("Presione");
	  Nokia5110_SetCursor(0,2);
	  Nokia5110_OutString("El teclado");
	  Nokia5110_SetCursor(0,3);
	  Nokia5110_OutString("Para jugar");
		lectura = UART0_DR_R;
		if(lectura > 0){
			break;
		}
	}
  TxCadena("Car racing primera version\n\r");
	Nokia5110_Clear();
	Nokia5110_OutString("Seleccione");
	Nokia5110_SetCursor(0,1);
	Nokia5110_OutString("un nivel");
	Nokia5110_SetCursor(0,2);
	Nokia5110_OutString("(1)(2)(3)");
	Nokia5110_SetCursor(0,4);
	Nokia5110_OutString("(4)(5)");
	nivel = 0;
	while(lectura != ' '){
		lectura = UART0_DR_R;
		if(lectura == 'd'){
			nivel = nivel + 1;
			if(nivel > 5){
			nivel = 1;
			}
			for(i = 0; i <30000; i++){}
		}
		else if(lectura == 'a'){
			nivel = nivel - 1;
			if(nivel < 1){
				nivel = 5;
			}
			for(i = 0; i <30000; i++){}
		}
		Nokia5110_ClearBuffer();
	  Nokia5110_PrintBMP(selector_x[nivel], selector_y[nivel], Selector, 2);
	  Nokia5110_DisplayBuffer();
	  Nokia5110_OutString("Seleccione");
	  Nokia5110_SetCursor(0,1);
	  Nokia5110_OutString("un nivel");
	  Nokia5110_SetCursor(0,2);
	  Nokia5110_OutString("(1)(2)(3)");
	  Nokia5110_SetCursor(0,4);
	  Nokia5110_OutString("(4)(5)");
		for(i = 0; i<80000;i++){}
	}
	while(1){
		lectura =  UART0_DR_R;
		if(lectura=='a'){
			x=x-31;
		}
		if(lectura=='d'){
  		x=x+31;
		}
		if(x > 65){
			x = 65;
		}
		if(x < 5){
			x = 5;
		}
		Nokia5110_ClearBuffer();
		Nokia5110_PrintBMP(x, 47, Enemy10Point1, 2);
		Nokia5110_DisplayBuffer();
		Camino();
    for(i = 0 ; i<32000; i++){}
	}
	return 0;
}